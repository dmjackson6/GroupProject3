using System.ComponentModel.DataAnnotations;
using System.ComponentModel.DataAnnotations.Schema;

namespace ProjectTutwiler.Models;

public class Vulnerability
{
    [Key]
    [DatabaseGenerated(DatabaseGeneratedOption.Identity)]
    public int Id { get; set; }

    [Required]
    [MaxLength(50)]
    public string CveId { get; set; } = string.Empty;

    public DateTime? PublishedDate { get; set; }

    [Required]
    [Column(TypeName = "text")]
    public string Description { get; set; } = string.Empty;

    [Column(TypeName = "decimal(3,1)")]
    public decimal? CvssScore { get; set; }

    [MaxLength(100)]
    public string? CvssVector { get; set; }

    [Column(TypeName = "text")]
    public string? AffectedProducts { get; set; }

    [MaxLength(255)]
    public string? VendorName { get; set; }

    [Column(TypeName = "text")]
    public string? References { get; set; }

    [Required]
    [MaxLength(50)]
    public string SourceName { get; set; } = string.Empty;

    [Column(TypeName = "text")]
    public string? RawData { get; set; }

    public bool KnownExploited { get; set; } = false;

    public DateTime CreatedAt { get; set; } = DateTime.UtcNow;

    public DateTime UpdatedAt { get; set; } = DateTime.UtcNow;

    // Navigation properties
    public BioImpactScore? BioImpactScore { get; set; }
    public ICollection<ActionRecommendation> ActionRecommendations { get; set; } = new List<ActionRecommendation>();
}
